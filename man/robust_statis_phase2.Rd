% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/robust_statis_phase2.R
\name{robust_statis_phase2}
\alias{robust_statis_phase2}
\title{Robust STATIS Dual - Phase 2 (New Batches Evaluation)}
\usage{
robust_statis_phase2(
  new_data,
  variables,
  medians,
  mads,
  compromise_matrix,
  global_center
)
}
\arguments{
\item{new_data}{A data frame containing new batches to evaluate (usually out-of-control).}

\item{variables}{Character vector of variable names to use.}

\item{medians}{Named numeric vector of global medians from Phase 1 (one per variable).}

\item{mads}{Named numeric vector of global MADs from Phase 1 (one per variable, scaled by 1.4826).}

\item{compromise_matrix}{Robust compromise covariance matrix from Phase 1.}

\item{global_center}{Robust global center (vector) from Phase 1.}
}
\value{
A list with:
\describe{
\item{standardized_data}{Data frame with new data standardized using Phase 1 global medians and MADs.}
\item{chi_stats_by_batch}{Chi-squared statistics per batch using Hotelling-type T² formulation.}
\item{threshold}{Chi-squared control limit at 0.9973 quantile, df = number of variables.}
}
}
\description{
Applies the robust STATIS control chart methodology to new batches using the compromise matrix
and robust global center obtained in Phase 1. Each batch is summarized by a robust Hotelling-type
T² statistic using the batch mean (standardized globally) and the Phase 1 compromise matrix.
}
\examples{
data("datos_farma")
phase1 <- robust_statis_phase1(
  subset(datos_farma, Fase == "Fase 1" & Status == "Under Control"),
  variables = c("Concentration", "Humidity", "Dissolution", "Density")
)
new_data <- subset(datos_farma, Fase == "Fase 2")
result_phase2 <- robust_statis_phase2(
  new_data = new_data,
  variables = c("Concentration", "Humidity", "Dissolution", "Density"),
  medians = phase1$global_medians,
  mads = phase1$global_mads,
  compromise_matrix = phase1$compromise_matrix,
  global_center = phase1$global_center
)
result_phase2$chi_stats_by_batch
result_phase2$threshold
}
