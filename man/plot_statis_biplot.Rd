% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_statis_biplot.R
\name{plot_statis_biplot}
\alias{plot_statis_biplot}
\title{GH-Biplot of Robust STATIS Dual Compromise (Galindo-Hernández Biplot)}
\usage{
plot_statis_biplot(
  phase1_result,
  dims = c(1, 2),
  color_by = c("none", "weight", "distance"),
  highlight_batches = NULL
)
}
\arguments{
\item{phase1_result}{Result from \code{robust_statis_phase1()}, must include \code{compromise_matrix},
\code{robust_means}, \code{batch_statistics}, and \code{global_center}.}

\item{dims}{Numeric vector of length 2 indicating the dimensions to plot (default: c(1, 2)).}

\item{color_by}{Optional string to color batches: "none" (default), "weight" (from STATIS weights), or "distance" (Chi² stat).}

\item{highlight_batches}{Optional: Vector of batch names to enlarge and emphasize.}
}
\value{
A ggplot2 object representing the GH-Biplot:
\itemize{
\item Arrows: variables (based on eigenvectors of the compromise matrix)
\item Dots: robust centers of batches (projected)
\item Red point: global robust center (compromise)
}
}
\description{
Generates a GH-Biplot (Galindo-Hernández) using the compromise matrix obtained
from robust STATIS Dual (without trace normalization). It represents variables
as vectors (axes) and batch centers as projected points in a reduced 2D space.
}
\details{
This biplot enables visual interpretation of how batch centers relate to
the compromise structure derived from robust covariance matrices. Variables
are represented as vectors from the origin, while batch centers are projected
using the eigenvectors of the compromise matrix.
}
\examples{
# Simulate pharmaceutical manufacturing batches
datos <- simulate_pharma_batches()

# Apply robust STATIS Dual to Phase 1 under control batches
phase1_result <- robust_statis_phase1(
  data = subset(datos, Fase == "Fase 1" & Status == "Under Control"),
  variables = c("Concentration", "Humidity", "Dissolution", "Density")
)

# Basic biplot
plot_statis_biplot(phase1_result)

# Colored by STATIS weights
plot_statis_biplot(phase1_result, color_by = "weight")

# Colored by Chi² robust statistics
plot_statis_biplot(phase1_result, color_by = "distance")

# Highlighting specific batches
plot_statis_biplot(phase1_result, highlight_batches = c("Batch_1", "Batch_10"))
}
